{
  "validated_at": "2026-01-31T02:36:11.029Z",
  "summary": {
    "tables_checked": 105,
    "tables_missing": 0,
    "columns_checked": 756,
    "columns_phantom": 2,
    "fk_issues": 2,
    "rpc_missing": 5,
    "total_issues": 9
  },
  "issues": [
    {
      "severity": "P1",
      "category": "phantom_column",
      "table": "project_files",
      "column": "parent_file_id",
      "detail": "Column 'parent_file_id' does not exist on table 'project_files'",
      "references": [
        {
          "file": "app/api/project-files/search/route.ts",
          "line": 128
        },
        {
          "file": "app/api/project-files/search/route.ts",
          "line": 145
        },
        {
          "file": "app/api/project-files/search/route.ts",
          "line": 303
        },
        {
          "file": "app/api/project-files/search/route.ts",
          "line": 318
        },
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 94
        }
      ]
    },
    {
      "severity": "P1",
      "category": "phantom_column",
      "table": "project_files",
      "column": "version",
      "detail": "Column 'version' does not exist on table 'project_files'",
      "references": [
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 83
        },
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 97
        },
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 190
        },
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 194
        },
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 331
        },
        {
          "file": "app/api/project-files/versions/route.ts",
          "line": 335
        }
      ]
    },
    {
      "severity": "P1",
      "category": "fk_target_bug",
      "table": "ai_conversations",
      "column": "tenant_id",
      "detail": "ai_conversations.tenant_id references 'tenant_users.user_id' instead of 'tenants.id'",
      "references": []
    },
    {
      "severity": "P1",
      "category": "fk_target_bug",
      "table": "ai_conversations",
      "column": "tenant_id",
      "detail": "ai_conversations.tenant_id references 'tenant_users.tenant_id' instead of 'tenants.id'",
      "references": []
    },
    {
      "severity": "P2",
      "category": "non_existent_rpc",
      "table": "",
      "detail": "RPC function 'calculate_commission' does not exist (1 reference)",
      "references": [
        {
          "file": "app/[locale]/(dashboard)/financial/commissions/actions.ts",
          "line": 65
        }
      ]
    },
    {
      "severity": "P2",
      "category": "non_existent_rpc",
      "table": "",
      "detail": "RPC function 'calculate_polygon_area_sq_miles' does not exist (1 reference)",
      "references": [
        {
          "file": "app/api/storm-targeting/extract-addresses/route.ts",
          "line": 48
        }
      ]
    },
    {
      "severity": "P2",
      "category": "non_existent_rpc",
      "table": "",
      "detail": "RPC function 'jsonb_set_nested' does not exist (1 reference)",
      "references": [
        {
          "file": "lib/aria/function-registry.ts",
          "line": 2544
        }
      ]
    },
    {
      "severity": "P2",
      "category": "non_existent_rpc",
      "table": "",
      "detail": "RPC function 'increment' does not exist (6 references)",
      "references": [
        {
          "file": "lib/campaigns/execution-engine.ts",
          "line": 250
        },
        {
          "file": "lib/campaigns/execution-engine.ts",
          "line": 611
        },
        {
          "file": "lib/campaigns/execution-engine.ts",
          "line": 618
        },
        {
          "file": "lib/campaigns/execution-engine.ts",
          "line": 620
        },
        {
          "file": "lib/campaigns/execution-engine.ts",
          "line": 622
        },
        {
          "file": "lib/enrichment/enrichment-queue.ts",
          "line": 352
        }
      ]
    },
    {
      "severity": "P2",
      "category": "non_existent_rpc",
      "table": "",
      "detail": "RPC function 'increment_campaign_enrollments' does not exist (1 reference)",
      "references": [
        {
          "file": "lib/campaigns/trigger-handler.ts",
          "line": 236
        }
      ]
    }
  ]
}
