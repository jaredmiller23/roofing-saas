apiVersion: aces/v1
kind: TaskSpec
metadata:
  id: B6CAA27A-ADDHTMLC001
  title: Add HTML content for remaining document templates
  created: 2025-12-18 20:30:15.309947
  priority: 5
  archon_task_id: b6caa27a-77fd-401b-9922-541db909791f
  template: database-migration
context:
  goal: 'Three document templates are missing html_content:


    1'
  why: 'Pre-Roofing Inspection Form (both tenants)

    2. Project Completion Certificate (both tenants)

    3. Roof Inspection Report (both tenants)


    **Technical Context:**

    - Templates already exist in database - use UPDATE, NOT INSERT

    - Match exact template names from database

    - Follow existing template HTML style (see Residential Roofing Contract as reference)

    - Use {{placeholder}} syntax for dynamic fields

    - Both tenants need same updates (UPDATE by name affects both)


    **Lessons from Previous Failures:**

    - DO NOT use INSERT - templates exist

    - DO NOT reference columns that dont exist (is_default, slug)

    - DO use idempotent migration patterns

    - REST API needs both apikey AND Authorization headers to verify


    **Acceptance Criteria:**

    - [ ] Pre-Roofing Inspection Form has html_content

    - [ ] Project Completion Certificate has html_content

    - [ ] Roof Inspection Report has html_content

    - [ ] Migration pushed successfully

    - [ ] html_content verified via REST API'
  success_criteria:
  - Implementation matches requirements
  - Code follows project standards
  - All tests pass
  - TypeScript compilation succeeds
  - Linting passes with no warnings
  - Build process completes successfully
  background: 'Three document templates are missing html_content:


    1. Pre-Roofing Inspection Form (both tenants)

    2. Project Completion Certificate (both tenants)

    3. Roof Inspection Report (both tenants)


    **Technical Context:**

    - Templates already exist in database - use UPDATE, NOT INSERT

    - Match exact template names from database

    - Follow existing template HTML style (see Residential Roofing Contract as reference)

    - Use {{placeholder}} syntax for dynamic fields

    - Both tenants need same updates (UPDATE by name affects both)


    **Lessons from Previous Failures:**

    - DO NOT use INSERT - templates exist

    - DO NOT reference columns that dont exist (is_default, slug)

    - DO use idempotent migration patterns

    - REST API needs both apikey AND Authorization headers to verify


    **Acceptance Criteria:**

    - [ ] Pre-Roofing Inspection Form has html_content

    - [ ] Project Completion Certificate has html_content

    - [ ] Roof Inspection Report has html_content

    - [ ] Migration pushed successfully

    - [ ] html_content verified via REST API'
scope:
  modify:
  - migrations/**/*.sql
  - src/db/**/*.ts
  create:
  - migrations/**/*.sql
  do_not_touch:
  - package.json
  - package-lock.json
  - yarn.lock
  - .git/**
  - node_modules/**
  - dist/**
  - build/**
  - src/components/**
  - src/pages/**
  constraints:
  - Follow existing code patterns
  - Maintain TypeScript compliance
  - Do not break existing functionality
read_first:
- path: README.md
  reason: Understanding project structure and conventions
  required: true
  extract: []
changes: []
validation:
  pre_commit:
  - command: npm run typecheck
    expect: 'exit_code: 0'
    required: true
    timeout: 120
  - command: npm run lint -- --max-warnings 5
    expect: 'exit_code: 0'
    required: true
    timeout: 60
  post_commit: []
  assertions: []
